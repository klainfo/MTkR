---
title: "Bullet Graph"
author: "Marco Torchiano"
date: "`r Sys.Date()`"
output:
  pdf_document:
    fig_caption: yes
  rmarkdown::html_vignette:
    fig_caption: yes
vignette: >
  \VignetteIndexEntry{Bullet Graph}
  \VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---


Drawing bullet graphs using `R` is extremely easy by means of the `bulletgraph()` function.
he code has been released as open-source and is described on the project wiki page [https://github.com/mtorchiano/MTkR/wiki/Bullet-Graph].

To use the function you just need to download it from the above link and source its code:

```{r}
source("BulletGraph.R")
```

This documents reproduces the original [Bullet Graph Design Specification](http://www.perceptualedge.com/articles/misc/Bullet_Graph_Design_Spec.pdf) by Stephen Few (pending permission) with the figures generated by means of the `bulletgraph()` function.

The goal of this document is to show that the function is able to reproduce all the examples provided in the original specification document. In fact this document is written in R Markdown and converted to pdf / html using `knitr`

In addition to the original contents, the documents shows the `R` code that is used to generate the graphs (omitting a few embellishments and decorations).

With respect to the original specification, there is only one limitation: 

* currently the function is able to draw only horizontal bullet graphs, therefore no vertical arrangement is possible yet.

There are two minor additions I made to the original specification

* when a non-zero base is used for the quantitative scale a jagged base is drawn to emphasize this possible perceptual problem;
* an explicit sub-label parameter is used to be able to reproduce the original examples.

---

# Bullet Graph Design Specification
by Stephen Few

(based on revision from October 10, 2013 )

## Overview

The bullet graph was developed to replace the meters and gauges that are often used on dashboards. Its linear and no-frills design provides a rich display of data in a small space, which is essential on a dashboard. Like most meters and gauges, bullet graphs feature a single quantitative measure (for example, year-to-date revenue) along with complementary measures to enrich the meaning of the featured measure. Specifically, bullet graphs support the comparison of the featured measure to one or more related measures (for example, a target or the same measure at some point in the past, such as a year ago) and relate the featured measure to defined quantitative ranges that declare its qualitative state (for example, good, satisfactory, and poor). Its linear design not only gives it a small footprint, but also supports more efficient reading than radial meters.

The bullet graph consists of five primary components:

* Text label
* A quantitative scale along a single linear axis
* The featured measure
* One or two comparative measures (optional)
* From two to five ranges along the quantitative scale to declare the featured measure’s
qualitative state (optional)

```{r, eval=FALSE}
bulletgraph(x=270,      # the featured measure
            ref=260,    # the comparative measure
            limits=c(0,200,250,300), # the ranges limits
            name= "Revenue 2005 YTD",  # the text label
            subname="(U.S. $ in thousands)"  # the sub-text label
            ) 
```

```{r, fig.show='hold',echo=FALSE,fig.width=7,fig.height=2.5,fig.cap="A standard bullet graph with each of its parts labeled."}
par(mar=c(7,9,3,2.2))
bulletgraph(x=270,ref=260,limits=c(0,200,250,300),
            name= "Revenue 2005 YTD",subname="(U.S. $ in thousands)")
par(fg="red")
segments(c(0,    0,300,200,250,150),
         c(1.3,1.5,1.5,1.5,1.5,1.5),
         c(  0,300,300,200,250,150),
         c(1.5,1.5,1.3,1.3,1.3,1.9),
         xpd=T)
mtext("Background fill colors that encode qualitative ranges like bad, satisfactory, and good", side=3,line=2,cex=0.9)
segments(c( -10, -10,-105, -60 ),
         c( 0.1, 0.1, 0.1, 0.1 ),
         c(-105, -10,-105, -60 ),
         c( 0.1, 0.2, 0.2,-0.3 ),
         xpd=T)
mtext("Text Label", side=1,line=1,at=-60,cex=0.9)
segments(c(  0,  0,300,150),
         c(-.7,-.9,-.7,-.9),
         c(  0,300,300,150),
         c(-.9,-.9,-.9,-1.3),
         xpd=T)
mtext("Quantitative Scale", side=1,line=3.5,cex=0.9)
segments(80,.7,80,-2,xpd=T)
mtext("Bar that encodes the performance measure", side=1,line=4.7,at=80,cex=0.9)
segments(260,.3,260,-2.5,xpd=T)
mtext("Symbol marker that encodes the comparative measure", side=1,line=6,at=210,cex=0.9)
par(fg="black")
```


```{r, fig.show='hold',echo=TRUE,fig.width=5,fig.height=3.5,fig.cap="One examples of multiple bullet graphs: arranged horizontally (vertical arrangement is not supported yet)"}
par(mfrow=c(5,1))
par(mar=c(3,9,.5,.5))
bulletgraph(x=270,ref=260,limits=c(0,200,250,300),
            name= "Revenue",subname="U.S. $ (1,000s)")
bulletgraph(x=.225,ref=.27,limits=c(0,.2,.25,.3),
            name= "Profit",subname="%")
bulletgraph(x=325,ref=550,limits=c(0,350,500,600),
            name= "Avg Order Size",subname="U.S. $")
bulletgraph(x=1700,ref=2050,limits=c(0,1450,2000,2500),
            name= "New Customers",subname="Count")
bulletgraph(x=4.7,ref=4.5,limits=c(0,3.5,4.2,5),
            name= "Cust Satisfaction",subname="Top Rating of 5")
```

## The Text Label

This portion of the bullet graph identifies the measure.  

#### Formatting Defaults:

* _Position_. To the left of horizontally-oriented graphs and above vertically-oriented graphs
* _Color, orientation, and size_. 100% black, horizontally oriented, and large enough to be
easily read

## The Quantitative Scale
This portion of the bullet graph looks and functions just like the quantitative scale on a two-dimensional XY graph. It consists of tick marks and text labels that identify equal intervals of measure along the bottom or top of the graph when oriented horizontally or along the left or right of the graph when oriented vertically. The tick marks may be positioned along either the inside or outside edge of the plot area. The quantitative range usually begins at zero, but may begin with a negative number if appropriate, and may also begin at a value greater than zero if it is useful to narrow the range of the scale to support a finer focus on the details.

#### Formatting Defaults:
* _Position_. On the bottom axis for a horizontally-oriented graph and on the left for a vertically-oriented graph. Tick marks should be located along the outside edge of the plot area.
* _Range of values_. Begins at zero, or less if the quantitative range includes negative numbers
* _Tick mark color and stroke_. Light gray with a thin stroke.
* _Text label color, orientation, and size_. 100% black, horizontally oriented, with a font that is small enough to fit along the scale without diminishing legibility


## The Featured Measure
This portion of the bullet graph displays the primary data and should therefore be visually prominent. Usually, it should be encoded as a bar, like the bar on a bar graph. The one exception is when the quantitative scale begins at a value greater than zero; in such a case, the featured measure should be encoded as a symbol such as a dot or X.

#### Formatting Defaults:
* _Position_. Centered in the plot area with the endpoint aligned with its value along the quantitative scale
* _Color and stroke_. 100% black with a heavy stroke weight
* _Thickness_. Approximately 1/3rd the thickness of its container.
* _Border_. None

```{r, fig.show='hold',echo=TRUE,fig.width=6,fig.height=1.3,fig.cap="This example encodes the featured measure as an X, because the quantitative scale begins at a value that is greater than zero."}
par(mar=c(3,9,1,1))
bulletgraph(x=1150,ref=1230,limits=c(700,1100,1200,1300),
            name= "Revenue 2005 YTD",
            subname="(U.S. $ in thousands)")
```

## The Comparative Measure(s)
These objects should be less visually dominant than the featured measure, but easy to see in relation to the featured measure. It should always be encoded as a short line that runs perpendicular to the orientation of the graph. Whenever the featured measure intersects a comparative measure, the comparative measure should usually appear behind the featured measure.

#### Formatting Defaults:
* _Position_. Centered in the plot area and aligned with its value along the quantitative scale
* _Color and Stroke_. 100% black with a stroke that is clearly visible but less dominant than
the featured measure. When a second comparative measure is included, it should be 75% black.

```{r, fig.show='hold',echo=TRUE,fig.width=6,fig.height=1.3,fig.cap="This example includes two comparative measures."}
par(mar=c(3,9,1,1))
bulletgraph(x=270,ref=c(260,210),limits=c(0,200,250,300),
            name= "Revenue 2005 YTD",subname="(U.S. $ in thousands)")
```


## The Qualitative Ranges
These ranges not only communicate the qualitative state of the featured measure but also the degree to which it resides within that state. For instance, if the measure extends into a range that represents “good”, the distance that it travels into this range indicates how good it is. The number of qualitative ranges should be limited to a maximum of five and ideally to three. More than five qualitative states would require a level of perceptual reasoning that is not efficient enough for a dashboard. The range should be encoded as rectangles of fill color behind the measures laid out end-to-end, which combine to define the entire plot area of the graph.

#### Formatting Defaults:
* _Color_. Rather than using distinct hues, which might not be distinguishable by those who are colorblind, encode these ranges as distinct intensities from dark to light of a single hue. Use the darker color intensities for the poor states and the lighter color intensities for the favorable states. Use these intensities for the following numbers of ranges:
    + Two: 35% and 10% black
    + Three: 40%, 25%, and 10% black
    + Four: 50%, 35%, 20%, and 10% black
    + Five: 50%, 35%, 20%, 10%, and 3% black
* _Border_. None

## Alternative Designs
There are occasions when alternatives to the standard design of bullet graphs work more effectively. Two situations are common:

1. Both positive and negative values might need to be displayed in the bullet graph
2. When a series of related bullet graphs includes some values that are considered good
when they are high and some that are considered good when they are low, this distinction should be apparent

When a bullet graph needs to express both positive and negative values, such as one that is used to display profits that could go negative, in the case of losses, the following design can handle this quite well:

```{r, fig.show='hold',echo=TRUE,fig.width=6,fig.height=1.3,fig.cap="This example is designed to display both positive and negative values."}
par(mar=c(3,5,1,1))
bulletgraph(x=-20,ref=200,limits=c(-50,150,200,250),
            name= "Profit",subname="(1,000s)")
```

When a bullet graph is being used to display a value that should be interpreted differently than others that are shown, such as expenses, which are best when low rather than high, this difference can be represented in both of the following ways.

```{r, fig.show='hold',echo=TRUE,fig.width=5,fig.height=2.5,fig.cap="In this example, the sequence of the background fill colors for expenses has been reversed, but the bar runs in the usual direction."}
par(mfrow=c(3,1))
par(mar=c(3,9,1,1))
bulletgraph(x=270,ref=260,limits=c(0,200,250,300),
            name= "Revenue ($1,000s)")
bulletgraph(x=60,ref=75,limits=c(0,40,80,120),
            name= "Expenses ($1,000s)",
            reverse=T)                    # reverse qualitative states
bulletgraph(x=4.7,ref=4.5,limits=c(0,3.5,4.2,5),
            name= "Cust Satisfaction",subname="Top Rating of 5")
```

```{r, fig.show='hold',echo=TRUE,fig.width=5,fig.height=2.5,fig.cap="In this example, the sequence of the background fill colors has been reversed and both the direction in which the bar extends and the quantitative scale have been reversed. The bar begins at zero and grows from left to right to express negative values, which makes sense because expenses are funds that are lost and in that sense negative."}
par(mfrow=c(3,1))
par(mar=c(3,9,1,1))
bulletgraph(x=270,ref=260,limits=c(0,200,250,300),
            name= "Revenue ($1,000s)")
bulletgraph(x=-60,ref=-75,limits=-c(0,40,80,120), # negative values
            name= "Expenses ($1,000s)",
            reverse=T)                            # reverse qualitative states
bulletgraph(x=4.7,ref=4.5,limits=c(0,3.5,4.2,5),
            name= "Cust Satisfaction",subname="Top Rating of 5")
```

Besides expenses, another example of this is the display of defects in a manufacturing process, which we want to remain below some defined threshold.

## Optional Features
Whenever you compare a current measure to a future target (for example, revenue as of January 15 compared to a Quarter 1 target), you can easily see how far you are from the target, but it’s not always so easy to tell if you are on track to meet or surpass that future target, which could still be weeks or even months away. This is true whether you are using a bullet graph or any other graphical means to display this information. This shortcoming in the usefulness of the comparison can be ameliorated by adding a projection of where you’ll be at the end of the period of time that is relevant to the target. This provides a rich display that tells you not only how far along you are on the path to the future target, but also how well you’re doing today in relation to that target.

```{r, fig.show='hold',echo=TRUE,fig.width=6,fig.height=1.3,fig.cap="This example splits the revenue measure into two segments: the actual measure as of today, and the projected measure of revenue based on current performance.",fig.pos="h"}
par(mar=c(3,9,1,1))
bulletgraph(x=60,ref=c(250),limits=c(0,200,250,300),
            projection=260,  # the projected final measure based on current performance
            col="steelblue",
            name= "Revenue 2005 YTD",subname="(U.S. $ in thousands)")
```

